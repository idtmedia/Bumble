// jQuery LimitKeypress jQuery Plugin 03/03/2016
// brianjaeger.com
(function($){$.fn.limitkeypress=function(g){var h={rexp:/^[-+]?\d*\.?\d*$/};var g=$.extend(h,g);var j=(function(){var a,v=3,div=document.createElement("div"),all=div.getElementsByTagName("i");while(div.innerHTML="<!--[if gt IE "+(++v)+"]><i></i><![endif]-->",all[0]);return v>4?v:a}());return this.each(function(){var f=g.rexp;$(this).blur(function(){sanitize(this)});$(this).keypress(function(e){if(e.which=="0"||e.which=="8"||e.which=="13"||e.which=="115"||e.ctrlKey||e.altKey){return}sanitizeWithSelection(this);var a=String.fromCharCode(e.which),updatedInput=this.value.substring(0,getSelectionStart(this))+a+this.value.substring(getSelectionEnd(this),this.value.length);if(!f.test(updatedInput)){e.preventDefault()}return});function sanitizeWithSelection(o){var a=getSelectionStart(o),endCaretPos=getSelectionEnd(o),temp="",testPlusChar="",selectionCharInfo=[];for(i=0;i<o.value.length;i++){if(a>i){selectionCharInfo[i]="beforeSelection"}else if((a<=i)&&(endCaretPos>i)){selectionCharInfo[i]="inSelection"}}for(i=0;i<o.value.length;i++){var b=i+1;testPlusChar+=o.value.substring(i,b);if((!f.test(testPlusChar))){var c=testPlusChar.length-1;temp=testPlusChar.substring(0,c);testPlusChar=temp;if(selectionCharInfo[i]=="beforeSelection"){a=a-1;endCaretPos=endCaretPos-1}else if(selectionCharInfo[i]=="inSelection"){endCaretPos=endCaretPos-1}}}o.value=testPlusChar;setSelectionRange(o,a,endCaretPos)}function sanitize(o){var a="",testPlusChar="";for(i=0;i<o.value.length;i++){var b=i+1;testPlusChar+=o.value.substring(i,b);if((!f.test(testPlusChar))){var c=testPlusChar.length-1;a=testPlusChar.substring(0,c);testPlusChar=a}}o.value=testPlusChar}function getSelectionStart(o){if(j<9){var r=document.selection.createRange().duplicate();r.moveEnd("character",o.value.length);if(r.text==""){return o.value.length}return o.value.lastIndexOf(r.text)}else{return o.selectionStart}}function getSelectionEnd(o){if(j<9){var r=document.selection.createRange().duplicate();r.moveStart("character",-o.value.length);return r.text.length}else{return o.selectionEnd}}function setSelectionRange(a,b,c){if(a.setSelectionRange){a.focus();a.setSelectionRange(b,c)}else if(a.createTextRange){var d=a.createTextRange();d.collapse(true);d.moveEnd("character",c);d.moveStart("character",b);d.select()}}})}})(jQuery);
