!function($){"use strict";window.alsp_ajaxImageFileUploadToGallery=function(e,t,r,a,o){if(""!=$("#"+e).val())return alsp_ajax_loader_show(),r&&(a+="&crop=1"),$.alsp_ajaxFileUpload({url:a,secureuri:!1,fileElementId:e,dataType:"json",success:function(e,r){void 0!==e.error_msg&&(""!=e.error_msg?alert(e.error_msg):t(e))},error:function(e,t,r){alert(r)},complete:function(){alsp_ajax_loader_hide()}}),!1;alert(o)},$.extend({alsp_createUploadIframe:function(e,t){var r="jUploadFrame"+e;if(window.ActiveXObject){if(!$.browser.msie||"9.0"!=$.browser.version&&"10.0"!=$.browser.version)var a=document.createElement('<iframe id="'+r+'" name="'+r+'" />');else(a=document.createElement("iframe")).setAttribute("id",r),a.setAttribute("name",r);"boolean"==typeof t?a.src="javascript:false":"string"==typeof t&&(a.src=t)}else{(a=document.createElement("iframe")).id=r,a.name=r}return a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",document.body.appendChild(a),a},alsp_createUploadForm:function(e,t,r,a){var o="jUploadForm"+e,n="jUploadFile"+e,u=jQuery('<form  action="" method="POST" name="'+o+'" id="'+o+'" enctype="multipart/form-data"></form>'),l=jQuery("#"+t),c=jQuery(l).clone();return jQuery(l).attr("id",n),jQuery(l).before(c),jQuery(l).appendTo(u),jQuery('<input type=hidden name="server_path" value="'+r+'">').appendTo(u),jQuery('<input type=hidden name="allowed_types" value="'+a+'">').appendTo(u),jQuery(u).css("position","absolute"),jQuery(u).css("top","-1200px"),jQuery(u).css("left","-1200px"),jQuery(u).appendTo("body"),u},alsp_ajaxFileUpload:function(e){e=jQuery.extend({},jQuery.ajaxSettings,e);var t=(new Date).getTime(),r=jQuery.alsp_createUploadForm(t,e.fileElementId,e.serverPath,e.allowed_types),a=(jQuery.alsp_createUploadIframe(t,e.secureuri),"jUploadFrame"+t),o="jUploadForm"+t;e.global&&!jQuery.active++&&jQuery.event.trigger("ajaxStart");var n=!1,u={};e.global&&jQuery.event.trigger("ajaxSend",[u,e]);var l=function(t){var o=document.getElementById(a);try{o.contentWindow?(u.responseText=o.contentWindow.document.body?o.contentWindow.document.body.innerHTML:null,u.responseXML=o.contentWindow.document.XMLDocument?o.contentWindow.document.XMLDocument:o.contentWindow.document):o.contentDocument&&(u.responseText=o.contentDocument.document.body?o.contentDocument.document.body.innerHTML:null,u.responseXML=o.contentDocument.document.XMLDocument?o.contentDocument.document.XMLDocument:o.contentDocument.document)}catch(t){jQuery.alsp_handleError(e,u,null,t)}if(u||"timeout"==t){var l;n=!0;try{if("error"!=(l="timeout"!=t?"success":"error")){var c=jQuery.alsp_uploadHttpData(u,e.dataType);e.success&&e.success(c,l),e.global&&jQuery.event.trigger("ajaxSuccess",[u,e])}else jQuery.alsp_handleError(e,u,l)}catch(t){l="error",jQuery.alsp_handleError(e,u,l,t)}e.global&&jQuery.event.trigger("ajaxComplete",[u,e]),e.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop"),e.complete&&e.complete(u,l),jQuery(o).unbind(),setTimeout(function(){try{jQuery(o).remove(),jQuery(r).remove()}catch(t){jQuery.alsp_handleError(e,u,null,t)}},100),u=null}};e.timeout>0&&setTimeout(function(){n||l("timeout")},e.timeout);try{r=jQuery("#"+o);jQuery(r).attr("action",e.url),jQuery(r).attr("method","POST"),jQuery(r).attr("target",a),r.encoding?r.encoding="multipart/form-data":r.enctype="multipart/form-data",jQuery(r).submit()}catch(t){jQuery.alsp_handleError(e,u,null,t)}return window.attachEvent?document.getElementById(a).attachEvent("onload",l):document.getElementById(a).addEventListener("load",l,!1),{abort:function(){}}},alsp_uploadHttpData:function(r,type){var data=!type;return data="xml"==type||data?r.responseXML:r.responseText,"script"==type&&jQuery.globalEval(data),"json"==type&&eval("data = "+data),"html"==type&&jQuery("<div>").html(data).evalScripts(),data},alsp_handleError:function(e,t,r,a){e.error&&e.error.call(e.context||window,t,r,a),e.global&&(e.context?jQuery(e.context):jQuery.event).trigger("ajaxError",[t,e,a])}})}(jQuery);